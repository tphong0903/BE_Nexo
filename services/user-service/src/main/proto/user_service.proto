syntax = "proto3";

package org.nexo.grpc.user;

option java_package = "org.nexo.grpc.user";
option java_outer_classname = "UserServiceProto";

service UserService {
  rpc CreateUser(CreateUserRequest) returns (CreateUserResponse);
  rpc UpdateUserEmailVerification(UpdateEmailVerificationRequest) returns (UpdateEmailVerificationResponse);
  rpc UpdateAccountStatus(UpdateAccountStatusRequest) returns (UpdateAccountStatusResponse);
  rpc GetUserFollowees(GetUserFolloweesRequest) returns (GetUserFolloweesResponse);
  rpc GetUserDto(KeycloakId) returns (UserDto);
  rpc GetUserFollowings(GetUserFollowingsRequest) returns (GetUserFollowingsResponse);
  rpc GetUserDtoById(GetUserDtoByIdRequest) returns (UserDTOResponse);
}

message CreateUserRequest {
  string keycloak_user_id = 1;
  string email = 2;
  string username = 3;
  string full_name = 4;
}

message UserDto {
  int64 user_id = 1;
  string keycloak_user_id = 2;
  string email = 3;
  string username = 4;
  string full_name = 5;
}

message KeycloakId {
  string keycloak_user_id = 1;
}
message CreateUserResponse {
  bool success = 1;
  string message = 2;
  int64 user_id = 3;
}

message UpdateEmailVerificationRequest {
  string keycloak_user_id = 1;
  bool email_verified = 2;
}

message UpdateEmailVerificationResponse {
  bool success = 1;
  string message = 2;
}

message UpdateAccountStatusRequest {
  string keycloak_user_id = 1;
  string account_status = 2; // PENDING, ACTIVE, INACTIVE, BLOCKED
}

message UpdateAccountStatusResponse {
  bool success = 1;
  string message = 2;
}

message GetUserFolloweesRequest {
  int64 user_id = 1;
}

message GetUserFolloweesResponse {
  bool success = 1;
  string message = 2;
  repeated FolloweeInfo followees = 3;
}

message GetUserFollowingsRequest {
  int64 user_id = 1;
}

message GetUserFollowingsResponse {
  bool success = 1;
  string message = 2;
  repeated FolloweeInfo followings = 3;
}

message FolloweeInfo {
  int64 user_id = 1;
  string user_name = 2;
  string avatar = 3;
  bool is_close_friend = 4;
}

message UserDTOResponse {
  int64 id = 1;
  string username = 2;
  string full_name = 3;
  string avatar = 4;
  string bio = 5;
  string created_at = 7;
}

message GetUserDtoByIdRequest {
  int64 user_id = 1;
}